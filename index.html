<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>Ordina la tua pizza üçï</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { 
      font-family: 'Garamond', serif; 
      margin: 0; 
      padding: 0; 
      background-color: #fff3e0; 
      color: #333; 
    }

    header {
      background-color: #d32f2f;
      text-align: center;
      padding: 20px 10px;
    }

    header img.stemma {
      max-width: 120px;
    }

    main {
      max-width: 600px;
      margin: 30px auto;
      padding: 0 20px;
    }

    form {
      background-color: #fff;
      padding: 20px;
      border-radius: 15px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    label { display: block; margin-top: 15px; font-family: 'Garamond', serif; }
    input, select, textarea, button { 
      width: 100%; 
      padding: 10px; 
      margin-top: 5px; 
      font-size: 16px; 
      border-radius: 5px; 
      border: 1px solid #ccc; 
      box-sizing: border-box; 
      font-family: 'Garamond', serif;
    }
    button { background-color: #d32f2f; color: white; border: none; cursor: pointer; transition: background 0.3s; font-size: 18px; }
    button:hover { background-color: #b71c1c; }

    .hidden { display: none; }

    /* Stile pizza */
    .pizza-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      background-color: #fff3e0;
      border: 1px solid #d32f2f;
      border-radius: 10px;
      padding: 10px 15px;
      margin-bottom: 12px;
      transition: transform 0.2s;
      font-family: 'Garamond', serif;
    }
    .pizza-item:hover { transform: translateY(-2px); }

    .pizza-left {
      display: flex;
      align-items: flex-start;
    }

    .pizza-left-top {
      display: flex;
      align-items: flex-start;
    }

    .pizza-left-top input[type="checkbox"] {
      width: 20px;
      height: 20px;
      margin-right: 12px;
      cursor: pointer;
      margin-top: 4px;
    }

    .pizza-info strong {
      font-size: 18px;
      color: #d32f2f;
    }

    .pizza-info span {
      font-size: 14px;
      color: #555;
      margin-top: 2px;
      display: block;
    }

    .pizza-qty input[type="number"] {
      width: 60px;
      font-size: 16px;
      padding: 5px;
    }

    /* Responsive */
    @media (max-width: 500px) {
      .pizza-item {
        flex-direction: row;
        align-items: center;
      }
      .pizza-left {
        flex: 1;
      }
      .pizza-qty {
        margin-left: 10px;
      }
    }
  </style>
</head>
<body>

<header>
  <img src="stemmaAlfiero.png" alt="Stemma Pizzeria Alfiero" class="stemma">
</header>

<main>
  <form id="ordine" action="https://formspree.io/f/myzpablp" method="POST">

    <label>Nome:
      <input type="text" name="nome" required>
    </label>

    <label>Telefono:
      <input type="text" name="telefono" required>
    </label>

    <label>Tipo di ordine:
      <select name="tipo_ordine" id="tipo_ordine" required>
        <option value="asporto">Asporto</option>
        <option value="domicilio">Domicilio</option>
      </select>
    </label>

    <div id="consegna_extra" class="hidden">
      <label>Zona di consegna:
        <select name="zona" id="zona">
          <option value="marina_di_carrara">Marina di Carrara</option>
          <option value="carrara">Carrara</option>
          <option value="marina_di_massa">Marina di Massa</option>
          <option value="massa">Massa</option>
          <option value="forte_dei_marmi">Forte dei Marmi</option>
        </select>
      </label>

      <label>Indirizzo:
        <input type="text" name="indirizzo" id="indirizzo">
      </label>
    </div>

    <label>Orario:
      <select name="orario" id="orario">
        <option value="19:15">19:15</option>
        <option value="20:00">20:00</option>
        <option value="21:00">21:00</option>
      </select>
    </label>

    <label>Pizze:</label>

    <div class="pizza-item">
      <div class="pizza-left">
        <div class="pizza-left-top">
          <input type="checkbox" id="margherita" name="pizza[]" value="Margherita">
          <div class="pizza-info">
            <strong>Margherita</strong>
            <span>Pomodoro, mozzarella</span>
          </div>
        </div>
      </div>
      <div class="pizza-qty">
        <input type="number" name="quantit√†_margherita" min="1" value="1" disabled>
      </div>
    </div>

    <div class="pizza-item">
      <div class="pizza-left">
        <div class="pizza-left-top">
          <input type="checkbox" id="diavola" name="pizza[]" value="Diavola">
          <div class="pizza-info">
            <strong>Diavola</strong>
            <span>Pomodoro, mozzarella, salame piccante</span>
          </div>
        </div>
      </div>
      <div class="pizza-qty">
        <input type="number" name="quantit√†_diavola" min="1" value="1" disabled>
      </div>
    </div>

    <div class="pizza-item">
      <div class="pizza-left">
        <div class="pizza-left-top">
          <input type="checkbox" id="capricciosa" name="pizza[]" value="Capricciosa">
          <div class="pizza-info">
            <strong>Capricciosa</strong>
            <span>Pomodoro, mozzarella, funghi, prosciutto, carciofi</span>
          </div>
        </div>
      </div>
      <div class="pizza-qty">
        <input type="number" name="quantit√†_capricciosa" min="1" value="1" disabled>
      </div>
    </div>

    <label>Note aggiuntive:
      <textarea name="note" rows="3"></textarea>
    </label>

    <button type="submit">Invia ordine</button>
  </form>
</main>

<script>
  const tipoOrdine = document.getElementById("tipo_ordine");
  const consegnaExtra = document.getElementById("consegna_extra");
  const zona = document.getElementById("zona");
  const orario = document.getElementById("orario");
  const indirizzo = document.querySelector('input[name="indirizzo"]');

  tipoOrdine.addEventListener("change", () => {
    if (tipoOrdine.value === "domicilio") {
      consegnaExtra.classList.remove("hidden");
      indirizzo.setAttribute("required", "required");
      aggiornaOrari();
    } else {
      consegnaExtra.classList.add("hidden");
      indirizzo.removeAttribute("required");
      resetOrariAsporto();
    }
  });

  zona.addEventListener("change", aggiornaOrari);

  function aggiornaOrari() {
    orario.innerHTML = "";
    if (zona.value === "forte_dei_marmi") {
      ["19:15", "20:00", "21:00"].forEach(h => {
        let opt = document.createElement("option");
        opt.value = h;
        opt.textContent = h;
        orario.appendChild(opt);
      });
    } else {
      ["19:15", "21:00"].forEach(h => {
        let opt = document.createElement("option");
        opt.value = h;
        opt.textContent = h;
        orario.appendChild(opt);
      });
    }
  }

  function resetOrariAsporto() {
    orario.innerHTML = "";
    ["19:15", "20:00", "21:00"].forEach(h => {
      let opt = document.createElement("option");
      opt.value = h;
      opt.textContent = h;
      orario.appendChild(opt);
    });
  }

  document.querySelectorAll('.pizza-item input[type="checkbox"]').forEach(chk => {
    chk.addEventListener('change', function() {
      const qty = this.closest('.pizza-item').querySelector('input[type="number"]');
      qty.disabled = !this.checked;
    });
  });

  // üëá nuovo script per gestire redirect manuale dopo invio
  const form = document.getElementById('ordine');
  form.addEventListener('submit', async function(e) {
    e.preventDefault();
    const formData = new FormData(form);
    await fetch(form.action, {
      method: form.method,
      body: formData,
      headers: { 'Accept': 'application/json' }
    });
    window.location.href = "grazie.html";
  });
</script>

</body>
</html>
