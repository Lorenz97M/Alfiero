<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>Ordina la tua pizza - Pizzeria Alfiero üçï</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { 
      font-family: 'Garamond', serif; 
      margin: 0; 
      padding: 0; 
      background-color: #fff3e0; 
      color: #333; 
    }

    header {
      background-color: #d32f2f;
      color: white;
      text-align: center;
      padding: 20px 10px;
    }
    header .stemma {
      width: 60px; height: 60px; border-radius: 50%; object-fit: cover; border: 2px solid #fff;
      vertical-align: middle; margin-right: 10px;
    }
    header h1 { margin: 0; font-size: 1.8rem; font-weight: 600; }

    main {
      max-width: 640px;
      margin: 30px auto;
      padding: 0 20px;
    }

    form {
      background-color: #fff;
      padding: 20px;
      border-radius: 15px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    label { display: block; margin-top: 15px; }
    input, select, textarea, button { 
      width: 100%; 
      padding: 10px; 
      margin-top: 5px; 
      font-size: 16px; 
      border-radius: 8px; 
      border: 1px solid #ccc; 
      box-sizing: border-box; 
      font-family: 'Garamond', serif;
    }
    button { background-color: #d32f2f; color: white; border: none; cursor: pointer; transition: background 0.25s; font-size: 18px; }
    button:hover { background-color: #b71c1c; }

    .hidden { display: none !important; }

    /* Pizze: tutto dentro al riquadro */
    .pizza-item {
      display: flex;
      align-items: center;
      gap: 12px;
      background-color: #fffaf2;
      border: 1px solid #d32f2f;
      border-radius: 12px;
      padding: 12px;
      margin-bottom: 12px;
      word-wrap: break-word;
    }
    .pizza-item input[type="checkbox"] {
      width: 20px; height: 20px; flex-shrink: 0; cursor: pointer;
    }
    .pizza-info { flex: 1; min-width: 0; }
    .pizza-info strong { font-size: 18px; color: #d32f2f; display: block; }
    .pizza-info span { font-size: 14px; color: #555; display: block; margin-top: 2px; }
    .pizza-qty { width: 64px; flex-shrink: 0; text-align: right; }
    .pizza-qty input[type="number"] { width: 64px; text-align: center; }

    /* Responsive */
    @media (max-width: 520px) {
      .pizza-item { align-items: flex-start; }
      .pizza-qty { width: 100%; }
      .pizza-qty input[type="number"] { width: 100%; margin-top: 6px; }
    }
  </style>
</head>
<body>

<header>
  <h1>
    <img src="stemmaAlfiero.png" alt="Stemma Pizzeria Alfiero" class="stemma">
    Pizzeria Alfiero
  </h1>
</header>

<main>
  <form action="https://formspree.io/f/myzpablp" method="POST" id="ordineForm">

    <label>Nome:
      <input type="text" name="nome" required>
    </label>

    <label>Telefono:
      <input type="text" name="telefono" required>
    </label>

    <label>Tipo di ordine:
      <select name="tipo_ordine" id="tipo_ordine" required>
        <option value="asporto">Asporto</option>
        <option value="domicilio">Domicilio</option>
      </select>
    </label>

    <div id="consegna_extra" class="hidden">
      <label>Zona di consegna:
        <select name="zona" id="zona">
          <option value="marina_di_carrara">Marina di Carrara</option>
          <option value="carrara">Carrara</option>
          <option value="marina_di_massa">Marina di Massa</option>
          <option value="massa">Massa</option>
          <option value="forte_dei_marmi">Forte dei Marmi</option>
        </select>
      </label>

      <label>Indirizzo:
        <input type="text" name="indirizzo" id="indirizzo">
      </label>
    </div>

    <label>Orario:
      <select name="orario" id="orario">
        <option value="19:15">19:15</option>
        <option value="20:00">20:00</option>
        <option value="21:00">21:00</option>
      </select>
    </label>

    <label>Pizze:</label>

    <div class="pizza-item">
      <input type="checkbox" id="margherita" name="pizza[]" value="Margherita">
      <div class="pizza-info">
        <strong>Margherita</strong>
        <span>Pomodoro, mozzarella</span>
      </div>
      <div class="pizza-qty">
        <input type="number" name="quantit√†_margherita" min="1" value="1" disabled>
      </div>
    </div>

    <div class="pizza-item">
      <input type="checkbox" id="diavola" name="pizza[]" value="Diavola">
      <div class="pizza-info">
        <strong>Diavola</strong>
        <span>Pomodoro, mozzarella, salame piccante</span>
      </div>
      <div class="pizza-qty">
        <input type="number" name="quantit√†_diavola" min="1" value="1" disabled>
      </div>
    </div>

    <div class="pizza-item">
      <input type="checkbox" id="capricciosa" name="pizza[]" value="Capricciosa">
      <div class="pizza-info">
        <strong>Capricciosa</strong>
        <span>Pomodoro, mozzarella, funghi, prosciutto, carciofi</span>
      </div>
      <div class="pizza-qty">
        <input type="number" name="quantit√†_capricciosa" min="1" value="1" disabled>
      </div>
    </div>

    <label>Note aggiuntive:
      <textarea name="note" rows="3"></textarea>
    </label>

    <input type="hidden" name="_next" value="grazie.html">

    <button type="submit">Invia ordine</button>
  </form>
</main>

<script>
  const tipoOrdine = document.getElementById("tipo_ordine");
  const consegnaExtra = document.getElementById("consegna_extra");
  const zona = document.getElementById("zona");
  const orario = document.getElementById("orario");
  const indirizzo = document.getElementById("indirizzo");

  // Sincronizza stato dei campi di consegna (visibilit√† + required + disabled)
  function syncConsegnaFields() {
    const isDelivery = tipoOrdine.value === "domicilio";

    // visibilit√† blocco
    consegnaExtra.classList.toggle("hidden", !isDelivery);

    // abilitazione/validazione
    zona.disabled = !isDelivery;
    indirizzo.disabled = !isDelivery;
    indirizzo.required = isDelivery;

    // orari
    if (isDelivery) {
      aggiornaOrari();
    } else {
      resetOrariAsporto();
    }
  }

  tipoOrdine.addEventListener("change", syncConsegnaFields);

  // Orari dinamici in base alla zona
  zona.addEventListener("change", aggiornaOrari);

  function aggiornaOrari() {
    orario.innerHTML = "";
    const slots = (zona.value === "forte_dei_marmi") 
      ? ["19:15", "20:00", "21:00"]
      : ["19:15", "21:00"];
    for (const h of slots) {
      const opt = document.createElement("option");
      opt.value = h; opt.textContent = h;
      orario.appendChild(opt);
    }
  }

  function resetOrariAsporto() {
    orario.innerHTML = "";
    for (const h of ["19:15", "20:00", "21:00"]) {
      const opt = document.createElement("option");
      opt.value = h; opt.textContent = h;
      orario.appendChild(opt);
    }
  }

  // Abilita/disabilita quantit√† in base alla checkbox
  document.querySelectorAll('.pizza-item input[type="checkbox"]').forEach(chk => {
    chk.addEventListener('change', function() {
      const qty = this.closest('.pizza-item').querySelector('input[type="number"]');
      qty.disabled = !this.checked;
    });
  });

  // Esegui sincronizzazione all'avvio (copre anche i refresh/ritorni pagina)
  document.addEventListener('DOMContentLoaded', syncConsegnaFields);
</script>

</body>
</html>
